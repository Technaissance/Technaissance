function cleanString(e){if(void 0===e)return"";expressions={"…":" ","[ª]":"a","[º]":"o","–":" ","[’‘‹›‚]":" ","[“”«»„]":" "," ":" ",_:" ","″”":" ","'":" ","8221;":" ","amp;":"and","[Ññ]":"n","[Çç]":"c","[áàäÁÀÄ]":"a","[éèëÉÈË]":"e","[íìïÍÌÏ]":"i","[óòöÓÒÖ]":"o","[úùüÚÙÜ]":"u",'[\\[\\{\\]\\}\\^\\*\\<\\>€¨\\(\\)"ºª#¬~&\\|·`´¿\\?¡\\!@]':" ",":":" ",";":" ",",":" ","\\.":" ","-":" ","\\s+":" "};for(var a in expressions)expressions.hasOwnProperty(a)&&(e=e.replace(new RegExp(a,"g"),expressions[a]));return e.toLowerCase()}function cleanAsyncVars(){"undefined"!=typeof digitalData&&"function"==typeof digitalView&&(digitalData.page.pageActivity=digitalDataVacio.page.pageActivity,digitalData.application.interactionLevel=digitalDataVacio.application.interactionLevel,digitalData.application.errorType=digitalDataVacio.application.errorType)}function regDownload(e,a,t,o){"undefined"!=typeof digitalData&&"function"==typeof digitalLink&&(cleanAsyncVars(),digitalData.page.pageActivity.link.name=cleanString(e,255),digitalData.page.pageActivity.link.url=digitalData.page.pageInfo.pageName,digitalData.page.pageActivity.link.ext=a,digitalData.page.pageActivity.link.aux1=t,digitalData.page.pageActivity.link.aux2=o,digitalLink("Download Link",digitalData))}!function(){var e=navigator.userAgent.toLowerCase().indexOf("webkit")>-1,a=navigator.userAgent.toLowerCase().indexOf("opera")>-1,t=navigator.userAgent.toLowerCase().indexOf("msie")>-1;(e||a||t)&&document.getElementById&&window.addEventListener&&window.addEventListener("hashchange",function(){var e,a=location.hash.substring(1);/^[A-z0-9_-]+$/.test(a)&&(e=document.getElementById(a))&&(/^(?:a|select|input|button|textarea)$/i.test(e.tagName)||(e.tabIndex=-1),e.focus())},!1)}();var AudioPlayer=function(){function e(e){var a=Math.floor(e/60);return a+":"+(e-60*a).toString().substr(0,2)}function a(e){var a=(parseInt(e/3600),parseInt(e/60)%60),t=e%60,o=t.toFixed();return(a<10?"0"+a:a)+":"+(o<10?"0"+o:o)}function t(e){for(var a=0;a<e;a++)!function(){function e(){!1===o.paused?(o.pause(),r=!1,jQuery("#play-btn").removeClass("pause")):(i||(cleanAsyncVars(),digitalData.page.pageActivity.audio.nameOfPodcastDisplayed=digitalData.page.pageInfo.pageIntent+" podcast | "+cleanString(u),digitalData.page.pageActivity.audio.duration=Math.round(o.duration).toString(),digitalData.page.pageActivity.audio.id="",digitalData.page.pageActivity.audio.player="bbva podcast",digitalData.page.pageActivity.audio.quality="large",digitalData.page.pageActivity.audio.url=o.children[0].src,"undefined"!=typeof digitalLink&&digitalLink("Audio Player Start",digitalData),i=!0),o.play(),jQuery("#play-btn").addClass("pause"),r=!0)}function a(){o.pause(),o.currentTime=0,r=!1,jQuery("#play-btn").removeClass("pause")}function t(){o.muted=!o.muted,jQuery("#mute-btn").toggleClass("muted")}var o=(document.getElementById("player-container"),document.getElementById("player")),r=!1,n=document.getElementById("play-btn"),s=document.getElementById("close-bar"),l=document.getElementById("audio-link"),c=document.getElementById("mute-btn"),u=Helper.eliminar_tildes(jQuery(".player").parent().find(".title h1").text()).toLowerCase();null!=n&&n.addEventListener("click",function(){e()}),null!=s&&s.addEventListener("click",function(){a()}),null!=l&&l.addEventListener("click",function(){e()}),null!=c&&c.addEventListener("click",function(){t()})}()}function o(){function t(e){var a=e.offsetX/this.offsetWidth;o.currentTime=a*o.duration,p.value=a/100}var o=document.getElementById("player"),r=o.duration,i=o.currentTime,u=e(r);jQuery(".end-time").html(u);var d=a(i);jQuery(".start-time").html(d);var p=document.getElementById("seekObj");p.value=o.currentTime/o.duration,p.addEventListener("click",t),!n&&o.currentTime>=.25*o.duration&&("undefined"!=typeof digitalLink&&digitalLink("Audio Player 25",digitalData),n=!0),!s&&o.currentTime>=.5*o.duration&&("undefined"!=typeof digitalLink&&digitalLink("Audio Player 50",digitalData),s=!0),!l&&o.currentTime>=.75*o.duration&&("undefined"!=typeof digitalLink&&digitalLink("Audio Player 75",digitalData),l=!0),o.currentTime==o.duration&&(c||(digitalLink("Audio Player End",digitalData),c=!0),jQuery("#play-btn").removeClass("pause"))}function r(){jQuery("#player").on("timeupdate",function(){o()})}var i=!1,n=!1,s=!1,l=!1,c=!1;new Global;return{init:function(){t(jQuery("#player-container").length),r()}}},AuthorView=function(){return{renderListItem:function(e){var a="";return a+='<div class="col-6 col-xl-3">',a+='<div class="author-cube">',a=a+'<a href="'+window.location.origin+e.resourcename+'">',a=a+'<div class="author-img book" style="background-image: url(\''+window.location.origin+e.image_src+"');\">",e.wp_text_array.length>=2?"autor"==e.wp_text_array[1]&&(a+='<div class="ico-book"><span class="icon-book"></span></div>'):(console.log("Error en renderListItem: No existe el tipo de autor en wp_text_array"),console.log(e.wp_text_array)),"es"==Helper.getLanguageFromUrl()?a+='<div class="hover-layer"><span>Ver ficha del autor</span></div></div></a>':a+='<div class="hover-layer"><span>View author details</span></div></div></a>',a=a+'<div class="name"><a href="'+window.location.origin+e.resourcename+'">'+e.title+"</a></div>",a+='<div class="degree"></div></div>',a+="</div>"}}},Author=function(e){function a(e){"todos"==e?jQuery(".filter-article-item").each(function(){jQuery(this).show()}):jQuery(".filter-article-item").each(function(){jQuery(this).children().first().hasClass(e)?jQuery(this).show():jQuery(this).hide()})}function t(){jQuery(".author-dropdown select").change(function(){var e=(jQuery("option:selected",this),this.value),a=window.location.href;if(-1!==a.indexOf("/en/"))if(-1!==a.indexOf("collaborator"))if(posicion=a.indexOf("collaborator"),"all"!=e)if(-1!==a.indexOf("collaborator/article")){if("article"==e)return;a=a.substring(0,posicion-1)+"/collaborator/"+e}else{if("post"==e)return;a=a.substring(0,posicion-1)+"/collaborator/"+e}else a=a.substring(0,posicion);else-1!==a.indexOf("page")?"all"!==e&&(posicion=a.indexOf("page"),a=a.substring(0,posicion-1)+"/collaborator/"+e):"all"!==e&&(a=a+"collaborator/"+e);else if(-1!==a.indexOf("colaborador"))if(posicion=a.indexOf("colaborador"),"all"!=e)if(-1!==a.indexOf("colaborador/articulo")){if("articulo"==e)return;a=a.substring(0,posicion-1)+"/colaborador/"+e}else{if("post"==e)return;a=a.substring(0,posicion-1)+"/colaborador/"+e}else a=a.substring(0,posicion);else-1!==a.indexOf("page")?"all"!==e&&(posicion=a.indexOf("page"),a=a.substring(0,posicion-1)+"/colaborador/"+e):"all"!==e&&(a=a+"colaborador/"+e);window.location=a}),jQuery(".filtrar-temas a").click(function(){a(jQuery(this).data("valor")),jQuery(".filtrar-temas span").html(jQuery(this).html()),jQuery(".filtrar-temas .menu-btn").prop("checked",!1)})}function o(a){s.fq="( and wp_text:'autores' title:'*"+a+"*' content_language:'"+n+"')",jQuery.when(JsonManager.search(s)).then(function(t){if(jQuery("#inputTextFormAuthor").val(decodeURI(a.replace(/\+/g," "))),0!==t.hits.found){var o=t.hits.hit;r("");for(var n=new AuthorView,s=0;s<o.length;s++)o[s].fields.wp_double>0?jQuery(".author-list .row").append(n.renderListItem(o[s].fields)):console.log("JSON problem",id,e,o[s])}else{r('<span class="noresults">'+("es"==i?"No se han encontrado resultados":"Not results found")+"</span>")}jQuery(".author-list .svg-spinner").hide()},function(e){console.log("Error en searchAutores como resultado de la promesa"),console.log(e),r('<span class="noresults">Error de conexión. Por favor, inténtelo de nuevo.</span>')})}function r(e){jQuery(".knowledge-window").hide(),jQuery(".author-list .row").html(e),jQuery(".author-pagination-wrapper").hide(),jQuery(".authors-dropdown-wrapper").hide(),jQuery(".background-author-list p").hide()}var i,n,s={q:"*",project:e,fq:"",size:1e4,sort:"description asc"};return{init:function(){var e=Helper.getUrlParameter("searchauthors");i=Helper.getLanguageFromUrl(),n="es"==i?"es_ES":"en_US",t(),null!==e?o(e):jQuery(".author-list .svg-spinner").hide()}}},Comentarios=function(e,a){function t(){thread=location.pathname;var e="/bbva-components/comments/?project="+a+"&thread="+thread;jQuery.ajax({url:e,type:"GET",success:function(e){if(200==e.code){data=e.data,salida_html="";for(var a=0;a<data.length;a++){if(salida_html+='<div class="comments-content-wrapper"><div class="container"><div class="row"><div class="col-12 col-xl-9 "><div class="comments-content"><div class="row justify-content-center"><div class="col-md-10">',salida_html=salida_html+'<div class="user-content"><div class="avatar"></div> <span class="title"><span>'+data[a].alias+"</span></span></div>",salida_html+='<div class="row justify-content-end"><div class="col-md-10 "><div class="user-comment">',salida_html=salida_html+'<div class="date">'+Helper.dateSpanishFormat(data[a].date)+"</div>",salida_html=salida_html+'<div class="comment">'+data[a].content+"</div>",salida_html=salida_html+'<a href="#" class="respond" data-id="'+a+'">Responder</a>',salida_html+="</div></div></div>",data[a].replies.length>0){salida_html+='<div class="row justify-content-end"><div class="col-md-10">';for(var t=0;t<data[a].replies.length;t++)salida_html+='<div class="user-content">',salida_html=salida_html+'<div class="avatar"></div><span class="title"><span>'+data[a].replies[t].alias+"</span></span>",salida_html+="</div>",salida_html+='<div class="row justify-content-end"><div class="col-md-10 "><div class="user-comment">',salida_html=salida_html+'<div class="date">'+Helper.dateSpanishFormat(data[a].replies[t].date)+"</div>",salida_html=salida_html+'<div class="comment"><p>'+data[a].replies[t].content+"</p></div>",salida_html=salida_html+'<a href="#" class="respond" data-id="'+a+'">Responder</a>',salida_html+="</div></div></div>";salida_html+="</div></div>"}salida_html=salida_html,salida_html+="</div></div></div></div></div></div></div></div>"}jQuery("#comments-list").html(salida_html),o()}},error:function(e){}})}function o(){jQuery("#ow_recaptcha_2").html(""),jQuery("#reply-form-fake").length>0&&(contenido=jQuery("#reply-form-fake").html(),contenido=contenido.replace("ow_recaptcha_3","ow_recaptcha_2"),contenido=contenido.replace("col-xl-9","col-xl-12"),reply_html='<div class="comments-content-wrapper respond-form" id="reply-form">'+contenido+"</div>",jQuery("#comments-list .respond").click(function(e){e.preventDefault(),jQuery(".respond-form").each(function(){jQuery(this).remove()}),jQuery(this).closest(".comments-content").append(reply_html);var a=0;jQuery("body,html").stop(!0,!0).animate({scrollTop:parseInt(jQuery("#reply-form").offset().top)-parseInt("100")},500),setTimeout(function(){a=grecaptcha.render("ow_recaptcha_2",{sitekey:"6Le7RGAUAAAAAM_PShzOfM4yBxw_TYI28Kw_SEQR"}),grecaptcha.reset(a),jQuery("#reply-form .fake-placeholder").on("click",function(){jQuery("#reply-form #content-reply").focus()}),r(a)},300)}))}function r(o){jQuery("#comments-list .btn-submit").on("click",function(r){r.preventDefault();var i=["content-reply"];if(elem=jQuery(this),jQuery(document).on("change","#reply-form .content-textarea",function(){""===jQuery("#reply-form .content-textarea textarea").val().trim()&&jQuery("#reply-form .fake-placeholder").show()}),cleanAsyncVars(),digitalData.page.pageActivity.link.name="nuevo comentario","undefined"!=typeof digitalLink&&digitalLink("Internal Link",digitalData),void 0!=e){var n=0;elem.parents("#first-form").length?n=1:id_reply=jQuery("#reply-form").siblings(".justify-content-center").first().find(".respond").first().data("id");var s=grecaptcha.getResponse(o);if(grecaptcha&&0!=s.length){var l=e.get("optional_data"),c=l.name;if(!n&&!FormValidation.validarForm(i)){var u="/bbva-components/comments?project="+a,d=new Array;d=n?{alias:c,email:e.get("email"),content:jQuery("#content-first").val()}:{alias:c,email:e.get("email"),content:jQuery("#content-reply").val(),parentId:id_reply,"g-recaptcha-response":s},thread=location.pathname,jQuery.ajax({url:u+"&thread="+thread,type:"POST",data:d,success:function(e){200==e.code?(setTimeout(function(){t()},3e3),jQuery("#comments-list .content-message-ok").show(),jQuery("#comments-list textarea").hide(),jQuery("#comments-list .content-textarea").hide(),jQuery("#comments-list .error-campo").hide(),jQuery("#comments-list .content-captcha").hide(),jQuery("#comments-list .content-button").hide(),jQuery("#content-first").val("")):(jQuery(".content-message-ko").show(),jQuery("#content-first").val(""))},error:function(e){}})}}else FormValidation.invalidField(jQuery("#ow_recaptcha_2"))}else jQuery(".btn-start").click(function(e){e.preventDefault(),Helper.goToLogin()}),jQuery(".btn-register").click(function(e){e.preventDefault(),Helper.goToRegistration()})})}function i(){jQuery(".btn-start").click(function(e){e.preventDefault(),Helper.goToLogin()}),jQuery(".btn-register").click(function(e){e.preventDefault(),Helper.goToRegistration()}),jQuery("#first-form .btn-submit").on("click",function(o){o.preventDefault();var r=["content-first"];if(elem=jQuery(this),cleanAsyncVars(),digitalData.page.pageActivity.link.name="nuevo comentario","undefined"!=typeof digitalLink&&digitalLink("Internal Link",digitalData),void 0!=e){var i=1;elem.parents("#first-form").length&&(i=1);var n=grecaptcha.getResponse();if(grecaptcha&&0!=n.length){FormValidation.validField(jQuery("#ow_recaptcha_1"));var s=e.get("optional_data"),l=s.name;if(i&&!FormValidation.validarForm(r)){var c="/bbva-components/comments?project="+a,u=new Array;i&&(u={alias:l,email:e.get("email"),content:jQuery("#content-first").val(),"g-recaptcha-response":n}),thread=location.pathname,jQuery.ajax({url:c+"&thread="+thread,type:"POST",data:u,success:function(e){200==e.code?(t(),jQuery("#first-form .content-message-ok").show(),jQuery("#first-form textarea").hide(),jQuery("#first-form .content-textarea").hide(),jQuery("#first-form .error-campo").hide(),jQuery("#first-form .content-captcha").hide(),jQuery("#first-form .content-button").hide(),jQuery("#content-first").val("")):(jQuery("#first-form .content-message-ko").show(),jQuery("#content-first").val(""))},error:function(e){}})}}else FormValidation.invalidField(jQuery("#ow_recaptcha_1"))}else jQuery(".btn-start").click(function(e){e.preventDefault(),Helper.goToLogin()}),jQuery(".btn-register").click(function(e){e.preventDefault(),Helper.goToRegistration()})}),jQuery(document).on("focus",".content-textarea",function(e){e.preventDefault(),jQuery(".fake-placeholder").hide()}),jQuery(document).on("click",".fake-placeholder",function(e){e.preventDefault(),jQuery(".fake-placeholder").hide()}),jQuery("#reply-form .fake-placeholder").on("click",function(){jQuery("#reply-form #content-reply").focus()}),jQuery("#first-form .fake-placeholder").on("click",function(){jQuery("#first-form #content-first").focus()}),jQuery(document).on("change","#first-form .content-textarea",function(){""===jQuery("#first-form .content-textarea textarea").val().trim()&&jQuery("#first-form .fake-placeholder").show()}),jQuery(document).on("change","#reply-form .content-textarea",function(){""===jQuery("#reply-form .content-textarea textarea").val().trim()&&jQuery("#reply-form .fake-placeholder").show()})}return{init:function(){if(jQuery(".comments-header").length>0){if(t(),void 0!=e){jQuery(".login-comments-header").parent().parent().hide();var a=e.get("optional_data"),o=a.name;jQuery("#first-form .title").html(o),jQuery("#first-form").show()}else jQuery(".login-comments-header").parent().parent().show(),jQuery("#first-form").hide(),jQuery(".respond").hide();i()}}}},ContactaAutor=function(e,a){function t(){jQuery(".contact-author.conditional-login").on("click",function(a){void 0==e&&(a.preventDefault(),Helper.goToLoginFromContactAuthor(jQuery(this).attr("href")))}),jQuery("#submit-contacto-autor").on("click",function(e){e.preventDefault();var t=["consulta","legal"],o=new FormData;if(0==FormValidation.validarForm(t)){var r="/bbva-components/form?project="+a;o.append("formID",jQuery("#formID").val()),o.append("Identificador",jQuery("#formID").val()),o.append("Usuario",jQuery("#usuario").val()),o.append("E-mail",jQuery("#email").val()),o.append("Autor a contactar",jQuery("#autor").val()),o.append("Consulta",jQuery("#consulta").val()),jQuery.ajax({url:r,type:"POST",data:o,processData:!1,contentType:!1,success:function(e){jQuery(".action-box").hide(),200==e.code||202==e.code?jQuery(".content-message-ok").show():jQuery(".content-message-ko").show()},error:function(e){jQuery(".action-box").hide(),jQuery(".content-message-ko").show(),console.log("Error en comunicación con el API de Formularios")}})}})}return{init:function(){void 0!=jQuery("#autorRelacionado")&&0!=jQuery("#autorRelacionado").length&&(void 0==e||(jQuery("#usuario").val(e.get("username")),jQuery("#email").val(e.get("email")),jQuery("#autor").val(jQuery("#autorRelacionado").val()))),t()}}},ContactUs=function(e){function a(){jQuery("#submit-contacto").on("click",function(a){a.preventDefault();var t=["name","email","comment","legal"],o=new FormData,r=grecaptcha.getResponse();if(grecaptcha&&0!=r.length){if(FormValidation.validField(jQuery("#ow_recaptcha")),0==FormValidation.validarForm(t)){var i="/bbva-components/form?project="+e;o.append("g-recaptcha-response",r),o.append("formID",jQuery("#formID").val()),o.append("Identificador",jQuery("#formID").val()),o.append("Nombre completo",jQuery("#nombre_completo").val()),o.append("E-mail",jQuery("#email").val()),o.append("Tipo de usuario",jQuery("input[type=radio][name='group1']:checked").val()),o.append("Motivo",jQuery("#reason").val()),o.append("Comentario",jQuery("#comentario").val()),jQuery.ajax({url:i,type:"POST",data:o,processData:!1,contentType:!1,success:function(e){jQuery(".action-box").hide(),200==e.code||202==e.code?jQuery(".content-message-ok").show():jQuery(".content-message-ko").show()},error:function(e){jQuery(".action-box").hide(),jQuery(".content-message-ko").show(),console.log("Error en la comunicación con el API")}})}}else FormValidation.invalidField(jQuery("#ow_recaptcha"))})}return{init:function(){a()}}},Favorites=function(){return{setFavorites:function(e){if(void 0!=e){var a,t=e.get("custom"),o=t.favoritos;jQuery(".heart").each(function(){a=jQuery(this).data("id"),void 0!=o&&a in o&&jQuery(this).addClass("favorito")})}},favoritesOnClick:function(e){jQuery(document).on("click",".heart",function(){var a=jQuery(this).data("id"),t={id:a,name:jQuery('[data-id="'+a+'"]').data("name"),url:jQuery('[data-id="'+a+'"]').data("url")};"undefined"!=typeof BbvaComponent&&void 0!=e?jQuery(this).hasClass("favorito")?(Favorites.removeFavorite(a,e),jQuery.each(jQuery('[data-id="'+a+'"]'),function(){jQuery(this).removeClass("favorito")})):(Favorites.addFavorite(t,e),jQuery.each(jQuery('[data-id="'+a+'"]'),function(){jQuery(this).addClass("favorito")})):Helper.goToLoginWithFavorite(t)})},addFavorite:function(e,a){if(console.log("BbvaComponent.isLogged",BbvaComponent.isLogged()),BbvaComponent.isLogged()){var t=a.get("custom");if("object"==typeof t.favoritos)var o=t.favoritos;else var o={};o[e.id]=e,t.favoritos=o,a.set("custom",t),a.update(function(e){e?console.log("addFavorite: error update",e):console.log("addFavorite: actualización ok",e);var a=localStorage.getItem("returnAction"),t=localStorage.getItem("returnPage");"favorito"==a&&void 0!=t&&""!=t&&(Helper.setReturnPage(""),localStorage.setItem("returnAction",""),localStorage.setItem("returnActionParameter",""),window.location.href=t)})}else console.log("addFavorite: No logado")},removeFavorite:function(e,a){var t=a.get("custom"),o=t.favoritos;delete o[""+e],0==Object.keys(o).length&&(o={0:{empty:"empty"}}),t.favoritos=o,a.set("custom",t),a.update(function(e){e&&console.log("[error] Problema al actualizar los favoritos",e)})}}}(),FormValidation=function(){function e(e,a){var t="";switch(a){case"tlf":t=new RegExp("^(\\+34|0034|34)?[6|7|9][0-9]{8}$");break;case"cod_postal":t=new RegExp("^([0-4]{1}[1-9]{1}|[5]{1}[0-2]{1})[0-9]{3}$");break;case"email":t=new RegExp("^([a-zA-Z0-9_\\-\\.]+)@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.)|(([a-zA-Z0-9\\-]+\\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\\]?)$");break;case"date":t=new RegExp("^(?:19|20)[0-9]{2}-(?:(?:0[1-9]|1[0-2])-(?:0[1-9]|1[0-9]|2[0-9])|(?:(?!02)(?:0[1-9]|1[0-2])-(?:30))|(?:(?:0[13578]|1[02])-31))$");break;case"nif":t=new RegExp("^[0-9]{8}[TRWAGMYFPDXBNJZSQVHLCKET]{1}$");break;case"pasaporte":t=new RegExp("^[A-Z0-9<]{9}[0-9]{1}[A-Z]{3}[0-9]{7}[A-Z]{1}[0-9]{7}[A-Z0-9<]{14}[0-9]{2}$");break;case"residente":t=new RegExp("^[XYZ]{1}[0-9]{7}[TRWAGMYFPDXBNJZSQVHLCKET]{1}$");break;case"password":t=new RegExp("^(?=.*?[0-9].*?[0-9])(?=.*[a-zA-Z])[0-9a-zA-Z]{8,}$");break;default:return!1}return e.val().match(t)}function a(){return jQuery("#legal").is(":not(:checked)")?(FormValidation.invalidField(jQuery("#legal")),jQuery(".checkbox").addClass("error"),1):(FormValidation.validField(jQuery("#legal")),0)}function t(e){return""!=e.val()?(FormValidation.validField(e),0):(FormValidation.invalidField(e),1)}function o(){return e(jQuery("#email"),"email")?(FormValidation.validField(jQuery("#email")),0):(FormValidation.invalidField(jQuery("#email")),1)}function r(a){var t=0;return""==a.val()?(FormValidation.invalidField(a),t=1):"repeat_password"==a.attr("id")?a.val()==jQuery("#new_password").val()&&e(a,"password")?FormValidation.validField(a):(FormValidation.invalidField(a),t=1):e(a,"password")?FormValidation.validField(a):(FormValidation.invalidField(a),t=1),t}function i(){var a=0;return 0==jQuery("#old-password").val().length&&0==jQuery("#new-password").val().length&&0==jQuery("#repeat-password").val().length&&(FormValidation.validField(jQuery("#old-password")),FormValidation.validField(jQuery("#new-password")),FormValidation.validField(jQuery("#repeat-password"))),(0<jQuery("#old-password").val().length||0<jQuery("#new-password").val().length||0<jQuery("#repeat-password").val().length)&&(e(jQuery("#old-password"),"password")?FormValidation.validField(jQuery("#old-password")):(FormValidation.invalidField(jQuery("#old-password")),a=1),e(jQuery("#new-password"),"password")?FormValidation.validField(jQuery("#new-password")):(FormValidation.invalidField(jQuery("#new-password")),a=1),jQuery("#repeat-password").val()==jQuery("#new-password").val()&&e(jQuery("#repeat-password"),"password")?FormValidation.validField(jQuery("#repeat-password")):(FormValidation.invalidField(jQuery("#repeat-password")),a=1)),a}function n(){jQuery("#name, #comment, #consulta, #content-first, #content-reply").on("blur",function(){t(jQuery(this))}),jQuery("#email, #wp_remember_email").on("blur",function(){o()}),jQuery("#new_password, #repeat_password").on("blur",function(){r(jQuery(this))}),jQuery("#repeat-password, #new-password, #old-password").on("blur",function(){i()}),jQuery("#legal").on("change",function(){a()})}return{init:function(){n()},validarForm:function(e){if(jQuery.isEmptyObject(e))return!1;var n=0;return jQuery.each(e,function(e,s){switch(s){case"legal":n+=a();break;case"name":case"comment":case"content-first":case"content-reply":case"consulta":n+=t(jQuery("#"+s));break;case"email":case"wp_remember_email":n+=o();break;case"new_password":case"repeat_password":n+=r(jQuery("#"+s));break;case"repeat-password":case"new-password":case"old-password":n+=i()}}),n},validField:function(e){(e.is("input")||e.is("textarea"))&&e.removeClass("invalid"),e.siblings(".error-campo").css("display","none")},invalidField:function(e){(e.is("input")||e.is("textarea"))&&e.addClass("invalid"),e.siblings(".error-campo").css("display","block")}}}(),Global=function(){function e(){jQuery(".audio-link, .close-bar").click(function(){jQuery(".audio-link").toggleClass("active"),jQuery(".audio-player-bar").toggleClass("open")}),jQuery(".masonry-topics .tab-content, .search-results-custom .table-results, .author-list").append('<div class="svg-spinner"><svg class="spinner" viewBox="0 0 50 50"><circle class="path" cx="25" cy="25" r="20" fill="none" stroke-width="5"></circle></svg></div>')}function a(){jQuery("#categorySelect").on("change",function(e){e.preventDefault();var a=jQuery(this).val();window.location=a})}function t(){jQuery(".regDownload").on("click",function(e){var a=JSON.parse(this.dataset.info);void 0!=a&&(-1!=window.location.href.indexOf("bbvaopenmind")?regDownload(a.titulo,a.format,a.idioma,a.modo):(console.log("Descarga analytics: entorno no productivo"),regDownload(a.titulo,a.format,a.idioma,a.modo)))})}function o(){"true"!=jQuery.cookie("cookies_aceptadas")&&jQuery("#cookie-notice").fadeIn(),jQuery("#cn-accept-cookie").click(function(e){e.preventDefault(),jQuery.cookie("cookies_aceptadas",!0,{expires:60,path:"/"}),jQuery("#cookie-notice").fadeOut()})}function r(){jQuery(".dropdown-radio").find("input").change(function(){var e=jQuery(this).closest(".dropdown"),a=jQuery(this).attr("name"),t="input[name="+a+"]:checked",o=jQuery(t).closest(".dropdown-radio").text();e.find("button").text(o);e.find(t).val()}),jQuery(".nav-tabs-dropdown").on("click","li:not('.active') a",function(e){jQuery(this).closest("ul").removeClass("open")}).on("click","li.active a",function(e){jQuery(this).closest("ul").toggleClass("open")})}function i(){var e,a=document.documentElement,t=document.body,o=document.querySelector(".js-progress-bar");e=(a.scrollTop||t.scrollTop)/((a.scrollHeight||t.scrollHeight)-a.clientHeight)*100,o.style.width=e+"%"}function n(){jQuery(".quote-publication").click(function(){jQuery(".modal-quote").removeClass("hide")}),jQuery(".articulos-template-default").on("click","#modal-quote-content",function(e){e.target===this&&jQuery(".modal-quote").addClass("hide")}),jQuery(".articulos-template-default").on("click",".close-modal",function(){jQuery(".modal-quote").addClass("hide")})}function s(){var e=window.matchMedia("(max-width: 575px)"),a=jQuery(".navbar").height(),t=jQuery(".materia-bar-wrapper").height(),o=a+t;e.matches?jQuery(".materia-bar-wrapper").is(":visible")?jQuery(".header-js-push").height(o):jQuery(".header-js-push").height(a):jQuery(".header-js-push").height(jQuery(".header-js").height())}function l(){jQuery("#responsive-tabs").on("click",function(){jQuery("#responsive-tabs ul li").removeClass("active"),jQuery("#responsive-tabs ul").toggleClass("expanded"),jQuery(this).addClass("active")})}function c(){jQuery(window).scroll(function(){if(0!=jQuery("body.single-post").length||0!=jQuery("body.single-articulos").length){jQuery(this).scrollTop()>880&&jQuery(this).width()>=575?(jQuery(".single header").addClass("sticky"),jQuery(".navbar, .reading-time, .secondary-menu").addClass("sticky"),jQuery(".authors-bar-sticky").addClass("show")):(jQuery(".single header").removeClass("sticky"),jQuery(".navbar, .reading-time, .secondary-menu").removeClass("sticky"),jQuery(".authors-bar-sticky").removeClass("show"));var e=jQuery(".post-body").height(),a=e+830;jQuery(this).scrollTop()>1030&&jQuery(this).scrollTop()<a?jQuery(".shares").addClass("sticky"):jQuery(".shares").removeClass("sticky")}}),jQuery(document).on("click","[class^=shares] button.facebook",function(){cleanAsyncVars(),digitalData.application.interactionLevel="compartir en facebook","undefined"!=typeof digitalLink&&digitalLink("Interaction Link",digitalData),window.open("http://www.facebook.com/sharer.php?u="+location.href+"&t= "+document.title,"_blank")}),jQuery(document).on("click","[class^=shares] button.twitter",function(){var e=window.document.URL,a=window.document.title.replace(" - OpenMind",""),t=encodeURIComponent(a)+encodeURIComponent(" ")+encodeURIComponent(e)+encodeURIComponent(" via @bbvaOpenMind");cleanAsyncVars(),digitalData.application.interactionLevel="compartir en twitter","undefined"!=typeof digitalLink&&digitalLink("Interaction Link",digitalData),window.open("http://twitter.com/?status="+t,"_blank")})}return{init:function(){e(),a(),t(),n(),l(),o(),r(),document.addEventListener("scroll",i),jQuery(document).ready(s),jQuery(window).resize(s),c()}}};digitalDataVacio={versionDL:"",pageInstanceID:"",page:{pageInfo:{errorPage:"",pageName:"",pageIntent:"",pageSegment:"",sysEnv:"",version:"",channel:"",language:"",geoRegion:"",level1:"",level2:"",level3:"",level4:"",level5:"",level6:"",level7:"",level8:"",level9:"",level10:"",area:"",server:"",businessUnit:"",siteAppName:"",projectName:""},pageActivity:{search:{onSiteSearchResults:"",onSiteSearchTerm:"",onSiteSearchEnterTerm:""},link:{name:"",url:"",ext:"",aux1:"",aux2:"",aux3:""},video:{nameOfVideoDisplayed:"",duration:"",id:"",player:"",quality:"",url:""},audio:{nameOfPodcastDisplayed:"",duration:"",id:"",player:"",quality:"",url:""},loginType:""}},optimization:{attributes:[],event:{eventName:"",optimizationEvent:""}},internalCampaign:{attributes:[],event:{eventInfo:{eventName:"",siteActionName:""}}},user:{device:{userAgent:"",mobile:"",root:""},userState:"",profileID:"",userID:"",prospectID:"",segment:{global:"",profile:""},gender:"",country:"",state:"",age:"",civilStatus:"",educationLevel:"",jobType:""},application:{transactionID:"",application:{type:"",name:""},fulfillmentModel:"",typology:"",programTypeHired:"",offer:"",operationNumber:"",process:"",step:"",interactionLevel:"",isQualifiedVisits:"",state:"",errorType:"",earnings:"",expenses:"",customFields:"",globalApplication:""},products:{attributes:[],productPortfolio:[]},news:{id:"",originalTitle:"",title:"",type:"",originalPublishDate:"",modifiedDate:"",country:"",category:"",signature:"",author:"",countryAuthor:"",relatedId:"",relatedOriginalTitle:"",relatedPosition:"",profile:{lifeCycle:"",value:"",behaviour:""},product:"",channel:""}};var Helper=function(){function e(){return-1!=window.location.href.indexOf("/en/")?"en":"es"}function a(e){localStorage.setItem("returnPage",e)}function t(t,o,r){var i,n=e();i="login"==t?"en"==n?"/en/login/":"/login/":"en"==n?"/en/user-register/":"/registro-de-usuarios/",a("contacto-autor"==o?r:window.location.href),null!=o&&(localStorage.setItem("returnAction",o),null!=r&&localStorage.setItem("returnActionParameter",JSON.stringify(r))),window.location.href=window.location.origin+i}var o=["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"];return{dateSpanishFormat:function(e){var a=e.substring(0,4),t=parseInt(e.substring(4,6)),r=e.substring(6,8),i=e.substring(8,10),n=e.substring(10,12);return r+" "+o[t-1]+", "+a+" a las "+i+":"+n},eliminar_tildes:function(e){return e=e.replace(/á/g,"a").replace(/à/g,"a").replace(/ä/g,"a").replace(/â/g,"a").replace(/ª/g,"a").replace(/Á/g,"A").replace(/À/g,"A").replace(/Â/g,"A").replace(/Ä/g,"A").replace(/é/g,"e").replace(/è/g,"e").replace(/ë/g,"e").replace(/ê/g,"e").replace(/É/g,"E").replace(/È/g,"E").replace(/Ê/g,"E").replace(/Ë/g,"E").replace(/í/g,"i").replace(/ì/g,"i").replace(/ï/g,"i").replace(/î/g,"i").replace(/Í/g,"I").replace(/Ì/g,"I").replace(/Ï/g,"I").replace(/Î/g,"I").replace(/ó/g,"o").replace(/ò/g,"o").replace(/ö/g,"o").replace(/ô/g,"o").replace(/Ó/g,"O").replace(/Ò/g,"O").replace(/Ö/g,"O").replace(/Ô/g,"O").replace(/ú/g,"u").replace(/ù/g,"u").replace(/ü/g,"u").replace(/û/g,"u").replace(/Ú/g,"U").replace(/Ù/g,"U").replace(/Û/g,"U").replace(/Ü/g,"U").replace(/ñ/g,"n").replace(/Ñ/g,"N").replace(/ç/g,"c").replace(/Ç/g,"C").replace(/\'/g,'"')},hasNumber:function(e){return/\d/.test(e)},traduceCategoria:function(e,a){return"ciencia"==e||"science"==e||"science"==a||"ciencia"==a?"science":"economia"==e||"economy"==e||"economy"==a||"economia"==a?"economy":"humanidades"==e||"humanities"==e||"humanities"==a||"humanidades"==a?"humanities":"tecnologia"==e||"technology"==e||"technology"==a||"tecnologia"==a?"technology":void 0},getLanguageFromUrl:function(){return e()},getUrlParameter:function(e){var a={};return window.location.href.replace(location.hash,"").replace(/[?&]+([^=&]+)=?([^&]*)?/gi,function(e,t,o){a[t]=void 0!==o?o:""}),e?a[e]?a[e]:null:a},goToRegistration:function(){t("registro",null,null)},goToLogin:function(){t("login",null,null)},goToLoginWithFavorite:function(e){t("login","favorito",e)},goToLoginFromContactAuthor:function(e){t("login","contacto-autor",e)},setReturnPage:function(e){a(e)},
goToReturnPage:function(e){if(null!==localStorage.getItem("returnPage")&&""!=localStorage.getItem("returnPage")){var t=localStorage.getItem("returnPage"),o=localStorage.getItem("returnAction"),r=localStorage.getItem("returnActionParameter");"favorito"==o&&void 0!=r&&""!=r?(r=JSON.parse(r),Favorites.addFavorite(r,e)):(a(""),window.location.href=t)}},filtraMasPopularesPorIdioma:function(e,a){var t=new Array,o=new Array;if(e.length>0)for(var r=0;r<e.length;r++)void 0!==e[r]&&null!==e[r]&&43029!=e[r].title&&("en"==a&&-1!=e[r].thread.indexOf("/en/")?-1===o.indexOf(e[r].title)&&(o.push(e[r].title),t.push(e[r])):"es"==a&&-1==e[r].thread.indexOf("/en/")&&-1===o.indexOf(e[r].title)&&(o.push(e[r].title),t.push(e[r])));return t}}}(),Home=function(e,a){function t(e){var t={project:a};jQuery.when(JsonManager.mostPopularComponent(t)).then(function(a){var t=Helper.getLanguageFromUrl();n=Helper.filtraMasPopularesPorIdioma(a,t),o(e)},function(e){console.log("Error en getMasPopulares como resultado de la promesa"),console.log(e)})}function o(t){var o=Math.ceil(n.length/s);if(t<=o){var i,l,c;i=t*s-s+1,t<o?l=s:(l=(n.length-1)%s+1,jQuery(".more-posts a").hide()),c=t*s-s+l;for(var u=[],d=i-1;d<c;d++)u.push(n[d].title);var p="es"==Helper.getLanguageFromUrl()?"es_ES":"en_US",m={project:a,q:"*",fq:"( and (or wp_text:'post' wp_text:'articulos') (or wp_double:"+u.join(" wp_double:")+") content_language:'"+p+"')",size:s};jQuery.when(JsonManager.search(m)).then(function(a){for(var t=new PostView,o="",i=0;i<u.length;i++){for(var n=0;n<a.hits.hit.length&&parseInt(a.hits.hit[n].fields.wp_double)!=parseInt(u[i]);n++);n<a.hits.hit.length&&parseInt(a.hits.hit[n].fields.wp_double)==parseInt(u[i])&&(o+=t.rellenaPlantilla(a.hits.hit[n].fields))}r(o),Favorites.setFavorites(e)},function(e){console.log("Error en getHtmlPage como resultado de la promesa"),console.log(e)})}}function r(e){var a=jQuery(e),t=jQuery(".grid");t.masonry({itemSelector:".grid__item",columnWidth:".grid__sizer",gutter:38,percentPosition:!0}),t.append(a).masonry("appended",a),a.imagesLoaded(function(){t.masonry("layout")})}function i(){jQuery(".more-posts a").click(function(e){e.preventDefault();var a=jQuery(this).attr("data-page");o(a),a++,jQuery(this).attr("data-page",a)})}var n,s=12;return{init:function(){if(0!=jQuery(".home").length){var e=1;t(e),e++,jQuery(".more-posts a").attr("data-page",e),i()}}}};jQuery(document).ready(function(){var e="";e=window.location.href.indexOf("bbvaopenmind.com")>=0||window.location.href.indexOf("dv5p5jf9kaboz.cloudfront.net")>=0||window.location.href.indexOf("ec2-34-251-10-234.eu-west-1.compute.amazonaws.com")>=0?"iz8dl3pf":"jfwen8il",(new Global).init(),(new MaterializeManager).init(),new LoginRss(e).init(),(new Menu).init(),(new SearchBar).init(),new SearchResults(e).init(),new SearchTags(e).init(),new ContactUs(e).init(),new Author(e).init(),(new Book).init(),(new MultimediaManager).init(),new NewsletterManager(e).init(),(new AudioPlayer).init(),(new MateriaBar).init(),(new TimeLine).init(),"undefined"!=typeof BbvaComponent&&BbvaComponent.getUserLogged(function(a,t){BbvaComponent.isLogged()&&void 0!=t&&(user_profileID=Helper.eliminar_tildes(t.get("username")).toLowerCase()),new Comentarios(t,e).init(),new ContactaAutor(t,e).init(),new Perfil(t,e).init(),new UserManager(t,e).init(),new Home(t,e).init(),new PostList(t,e).init(),new PostPopularList(t,e).init(),(new Jump).init(),Favorites.favoritesOnClick(t);var o="",r="";void 0!=t?(o="logado",r=Helper.eliminar_tildes(t.get("username")).toLowerCase()):o="no logado",set_localStorage_user_estado(o,r)})});var JsonManager=function(){function e(e,a){var t="?";for(var o in a)a.hasOwnProperty(o)&&(e=e+t+o+"="+a[o],"?"==t&&(t="&"));return e}return{search:function(a){var t,o=jQuery.Deferred(),r="/bbva-components/search";return r=e(r,a),jQuery.ajax({url:r,type:"GET",success:function(e){null!=e&&200===e.code?(t=e.data,o.resolve(t)):o.reject(e)},error:function(e){o.reject(e)}}),o.promise()},mostPopularComponent:function(a){var t,o=jQuery.Deferred(),r="/bbva-components/mostpopular";return r=e(r,a),jQuery.ajax({url:r,type:"GET",success:function(e){null!=e&&200===e.code?(t=e.data,o.resolve(t)):o.reject(e)},error:function(e){o.reject(e)}}),o.promise()},getJsonFileById:function(e){var a=jQuery.Deferred(),t="/_htmls/post_"+e+"_wp-search.json";return jQuery.ajax({url:t,type:"GET",dataType:"json",contentType:"application/json",headers:{"Content-Type":"application/json"},success:function(e){null!=e?a.resolve(e):a.reject(e)},error:function(e){a.reject(e)}}),a.promise()},searchMockup:function(e){var a,t=jQuery.Deferred(),o="/wp-content/themes/openmind/backup/mocks/"+e;return jQuery.ajax({url:o,type:"GET",success:function(e){null!=e&&200===e.code?(a=e.data,t.resolve(a)):t.reject(e)},error:function(e){t.reject(e)}}),t.promise()},mostPopularComponentFromMockup:function(e){var a,t=jQuery.Deferred(),o="/wp-content/themes/openmind/backup/mocks/"+e;return jQuery.ajax({url:o,type:"GET",success:function(e){null!=e&&200===e.code?(a=e.data,t.resolve(a)):t.reject(e)},error:function(e){t.reject(e)}}),t.promise()}}}(),Jump=function(){function e(){jQuery("#login").on("click",function(){localStorage.setItem("returnPage","")}),jQuery(".refresh").on("click",function(){var e="";null!==localStorage.getItem("returnPage")&&""!=localStorage.getItem("returnPage")?(e=localStorage.getItem("returnPage"),localStorage.setItem("returnPage",""),window.location.href=e):location.reload()})}return{init:function(){e()}}},Book=function(){function e(){jQuery(".libros-template-default .responsive-tabs ul li a").on("click",function(e){var a=Helper.eliminar_tildes(jQuery(this).text().toLowerCase()),t=["articulos","articles","autores","authors","videos","posts","audios","audio"],o=!1,r="";t.forEach(function(e){window.location.pathname.indexOf(e)>1&&(o=!0,r=window.location.pathname.substring(0,window.location.pathname.lastIndexOf(e)))}),o&&r?window.history.pushState({},"",r+a):window.history.pushState({},"",window.location.pathname+a)})}return{init:function(){if(jQuery("body").hasClass("libros-template-default")){var a=window.location.pathname.split("/"),t=a[a.length-2];if(""!=t){switch(t){case"articles":t="articulos";break;case"authors":t="autores";break;case"audio":t="audios"}jQuery('.responsive-tabs a[href="#tab_'+t+'"]').tab("show")}}e()}}},LoginRss=function(e){function a(){t.attr("href",window.location.origin+"/rrss/?redir="+btoa(window.location.origin+("ES"==language?"/private/mi-perfil/":"/en/private/my-profile/"))+"&client_id="+e+"&social=FACEBOOK"),o.attr("href",window.location.origin+"/rrss/?redir="+btoa(window.location.origin+("ES"==language?"/private/mi-perfil/":"/en/private/my-profile/"))+"&client_id="+e+"&social=TWITTER")}var t,o;return{init:function(){t=jQuery(".wp_facebook_button"),o=jQuery(".wp_twitter_button"),t&&o&&a()}}},MasonryManager=function(){function e(){jQuery(".grid").masonry({itemSelector:".grid__sizer",columnWidth:".grid__sizer",gutter:38,percentPosition:!0})}function a(){jQuery(window).resize(function(){0==!jQuery(".popular-posts").length&&e()}),jQuery(".more-posts a span").click(function(){e()})}return{init:function(){0==!jQuery(".popular-posts").length&&e(),jQuery("a[data-toggle=tab]").each(function(){jQuery(this).on("shown.bs.tab",function(){e()})}),a()}}},MateriaBar=function(){function e(e){var a,t,o=decodeURIComponent(window.location.search.substring(1)),r=o.split("&");for(t=0;t<r.length;t++)if(a=r[t].split("="),a[0]===e)return void 0===a[1]||a[1]}return{init:function(){var a=e("utm_source"),t=e("tipo");void 0!=a&&"materia"==a.toLowerCase()?(jQuery("#materia-bar").css("display","block"),"recomienda"==t?jQuery("#materia-bar .recomienda").css("display","block"):jQuery("#materia-bar .elabora").css("display","block"),jQuery(this).scrollTop()>880?jQuery(".shares").addClass("stickyMateria"):jQuery(".shares").removeClass("stickyMateria")):jQuery("#materia-bar").css("display","none");var o=e("utm_medium");void 0!=o&&"facebook"==o&&jQuery("head").append("<meta property=“article:author” content=“https://www.facebook.com/Materia.Ciencia” />")}}},MaterializeManager=function(){function e(){jQuery(".hide-show").click(function(){var e=jQuery(this).siblings().siblings();e=e[0],"password"===e.type?e.type="text":e.type="password"}),jQuery(document).on("focusout",".form-control",function(){jQuery(".form-group").removeClass("focus")}),jQuery(document).on("focus",".form-control",function(){jQuery(this).closest(".form-group").addClass("focus")}),jQuery(document).on("keyup",".form-control",function(){jQuery(this).val().length>0?jQuery(this).closest(".form-group").addClass("filled"):jQuery(this).closest(".form-group").removeClass("filled")}),jQuery(document).on("click",".form-control",function(){jQuery(this).is(":checkbox")?jQuery(this).prop("checked")?jQuery(this).closest(".form-group").addClass("filled"):jQuery(this).closest(".form-group").removeClass("filled"):jQuery(this).closest(".form-group").addClass("focus")})}return{init:function(){jQuery("select").material_select(),setTimeout(function(){jQuery(".login-container").find(".form-control").each(function(){jQuery(this).is(":checkbox")||jQuery(this).length>0&&jQuery(this).parent().addClass("filled")})},500),e()}}},Menu=function(){function e(){jQuery("html, body").css({overflow:"initial",height:"100%"})}function a(){jQuery("html, body").css({overflow:"hidden",height:"100%"})}function t(){jQuery(".cat-1-js").addClass("active"),jQuery(".cat-2-js").removeClass("active")}function o(){jQuery(".cat-2-js").addClass("active"),jQuery(".cat-1-js").removeClass("active")}function r(){jQuery("#main-menu a").click(function(){jQuery(".velo").removeClass("hide"),a(),jQuery("#main-menu a").removeClass("active"),jQuery(this).addClass("active"),"TEMAS"==jQuery(this).attr("title")?t():o()}),jQuery(".velo").click(function(){jQuery(".velo").addClass("hide"),jQuery("#main-menu a").removeClass("active"),e()}),jQuery("#main-menu a").click(function(){jQuery(".velo-admin-bar").removeClass("hide"),a(),jQuery("#main-menu a").removeClass("active"),jQuery(this).addClass("active"),"TEMAS"==jQuery(this).attr("title")?t():o()}),jQuery(".velo-admin-bar").click(function(){jQuery(".velo-admin-bar").addClass("hide"),jQuery("#main-menu a").removeClass("active"),e()}),jQuery(window).resize(function(){jQuery(window).width()<767?e():jQuery(".menu-mobile-right").removeClass("right-open"),jQuery(window).width()<1200&&(jQuery(".velo").addClass("hide"),jQuery(".velo-admin-bar").addClass("hide"),jQuery("#main-menu a").removeClass("active"),e())}),jQuery(".item a").click(function(){jQuery(".item a").removeClass("active"),jQuery(this).addClass("active"),jQuery(".line").toggleClass("active"),jQuery(".content-topics").toggleClass("active");jQuery(this).attr("title")}),jQuery("#showRight").click(function(){jQuery(".menu-mobile-right").toggleClass("right-open")}),jQuery("#close-menu-mobile").click(function(){jQuery(".menu-mobile-right").removeClass("right-open")})}return{init:function(){r()}}},MultimediaManager=function(){function e(){jQuery(".page-template-multimedia .responsive-tabs ul li a").on("click",function(e){var a=window.location.pathname.split("/"),t="";"en"==a[1]&&(t="/en");var o=Helper.eliminar_tildes(jQuery(this).text().toLowerCase());"todos"!=o&&"all"!=o?window.history.pushState({},"",t+"/multimedia/"+o):window.history.pushState({},"",t+"/multimedia/")})}function a(){jQuery(".multimedia-modal-js").click(function(e){e.preventDefault(),jQuery(".multimedia-modal").removeClass("hide")}),jQuery("body").on("click","#multimedia-modal",function(e){e.target===this&&jQuery(".multimedia-modal").addClass("hide")}),jQuery("body").on("click",".close-modal",function(){jQuery(".multimedia-modal").addClass("hide")})}return{init:function(){if(jQuery("body").hasClass("page-template-multimedia")){var t=window.location.pathname.split("/"),o=t[t.length-1];if(""!=o){switch(o){case"puzzles":case"pasatiempos":o="#tab_pastimes";break;case"infographic":case"infografias":o="#tab_infographics";break;case"interactive":case"interactivos":o="#tab_interactives";break;case"quiz":o="#tab_quizs";break;case"audio":o="#tab_audios";break;default:o="#tab_"+o}jQuery('.responsive-tabs a[href="'+o+'"]').tab("show")}e()}a()}}},NewsletterManager=function(e){function a(){jQuery("#submit-newsletterV3").click(function(e){e.preventDefault();var a=["email","legal"],t=jQuery("#email").val();if(["www.bbvaopenmind.com","dv5p5jf9kaboz.cloudfront.net","ec2-34-251-10-234.eu-west-1.compute.amazonaws.com"].indexOf(window.location.hostname)>=0){var o="/bbva-components/v3/salesforce/messaging/v1/messageDefinitionSends/key:DOI_Email_OpenMind/send?project=iz8dl3pf";comms="COMMS_"}else{var o="/bbva-components/v3/salesforce/messaging/v1/messageDefinitionSends/key:TS_DOI_Email_OpenMind/send?project=jfwen8il";comms="COMMS_INT_"}version="a111",0==FormValidation.validarForm(a)&&(jQuery("#submit-newsletterV3").hide(),grecaptcha.ready(function(){grecaptcha.execute("6LeEO_MZAAAAAOHe26OLO1i-ASSzVBIwxCjnA_fT",{action:"submit"}).then(function(e){const a={clientResponse:e,To:{Address:t,SubscriberKey:comms+t,ContactAttributes:{SubscriberAttributes:{email:t,lang:language,legal_version:version}}},Options:{RequestType:"SYNC"}};jQuery.ajax({method:"POST",contentType:"application/json",data:JSON.stringify(a),dataType:"json",processData:!1,type:"POST",url:o,success:function(e){jQuery(".action-box").hide(),0==e.data.responses[0].hasErrors?jQuery(".content-message-ok").show():(jQuery(".content-message-ko").show(),console.log("Error en el código de respuesta del API"))},error:function(e){jQuery(".action-box").hide(),jQuery(".content-message-ko").show(),console.log("error en el código de respuesta del API")}})})}))}),jQuery(".newsletter-modal-js").click(function(){jQuery(".newsletter-modal").removeClass("hide")}),jQuery(".page-template-newsletter").on("click","#newsletter-modal",function(e){e.target===this&&jQuery(".newsletter-modal").addClass("hide")}),jQuery(".page-template-newsletter").on("click",".close-modal",function(){jQuery(".newsletter-modal").addClass("hide")})}return{init:function(){a()}}},PostList=function(e,a){function t(e,a){if(w.cursor=a,"initial"!=a){w.fq="all"===e?"( and "+m+":'"+g+"'(or wp_text:'post' wp_text:'articulos')  content_language:'"+p+"')":"( and "+m+":'"+g+"' wp_text:'"+e+"' content_language:'"+p+"')";var t=f?JsonManager.searchMockup("recientes_all_ciencia.json"):JsonManager.search(w);jQuery.when(t).then(function(a){s=a,o(e),localStorage.setItem("enProceso","false")},function(e){console.log("Error en resultadosBusqueda como resultado de la promesa"),console.log(e)})}else{w.fq="( and "+m+":'"+g+"' wp_text:'articulos' content_language:'"+p+"')";var r=f?JsonManager.searchMockup("recientes_articulos_ciencia.json"):JsonManager.search(w);w.fq="( and "+m+":'"+g+"' wp_text:'post' content_language:'"+p+"')";var i=f?JsonManager.searchMockup("recientes_post_ciencia.json"):JsonManager.search(w);w.fq="( and "+m+":'"+g+"'(or wp_text:'post' wp_text:'articulos')  content_language:'"+p+"')";var n=f?JsonManager.searchMockup("recientes_all_ciencia.json"):JsonManager.search(w);Promise.all([r,i,n]).then(function(e){s=e,o("articulos"),o("post"),o("all"),localStorage.setItem("enProceso","false")},function(e){console.log("Error en resultadosBusqueda como resultado de las promesas"),console.log(e)})}}function o(t){var o;"articulos"===t?(o=0!=h?s:s[0],l=o.hits.cursor,v++):"post"===t?(o=0!=h?s:s[1],c=o.hits.cursor,j++):"all"===t&&(o=0!=h?s:s[2],u=o.hits.cursor,Q++);var n=o.hits.found;if(0==n)r(t);else{var d=o.hits.hit.length;h*y+d>=n&&r(t);for(var p="",m=new PostView,g=0;g<d;g++)o.hits.hit[g].fields.wp_double>0?p+=m.rellenaPlantilla(o.hits.hit[g].fields):console.log("JSON problem",a,o.hits.hit[g]);i(p,t),Favorites.setFavorites(e)}}function r(e){"articulos"==e?jQuery("#articles .all .more-posts a").hide():"post"==e?jQuery("#posts .all .more-posts a").hide():"all"==e&&jQuery("#all .all .more-posts a").hide()}function i(e,a){var t,o=jQuery(e);"articulos"==a?t=jQuery("#articles .all .masonry-grid .grid"):"post"==a&&(t=jQuery("#posts .all .masonry-grid .grid")),"all"==a&&(t=jQuery("#all .all .masonry-grid .grid")),t.masonry({itemSelector:".grid__item",columnWidth:".grid__sizer",gutter:38,percentPosition:!0}),t.append(o).masonry("appended",o),o.imagesLoaded(function(){t.masonry("layout"),jQuery(".masonry-topics .tab-content .svg-spinner").hide()})}function n(){jQuery(".more-posts a.categoria").click(function(e){if(e.preventDefault(),"true"!==localStorage.getItem("enProceso")){localStorage.setItem("enProceso","true");var a=jQuery(this).data("type");"articulos"==a?(h=v,t(a,l)):"post"==a?(h=j,t(a,c)):"all"==a&&(h=Q,t(a,u))}else console.log("Esperando respuesta de paginación. Espere un instante para volver a paginar.")}),jQuery(".tax-temas .nav-tabs li a").on("click",function(){var e=jQuery(this).attr("href"),a=jQuery(e).find(".all .masonry-grid .grid");a.imagesLoaded(function(){a.masonry("destroy"),a.masonry({itemSelector:".grid__item",columnWidth:".grid__sizer",gutter:38,percentPosition:!0}),a.masonry("layout")})})}var s,l,c,u,d,p,m,g,f=!1,y=12,h=0,v=0,j=0,Q=0;""!=digitalData.page.pageInfo.level2?(m="category",g=digitalData.page.pageInfo.level2):(m="topic",g=digitalData.page.pageInfo.level1);var w={q:"*",project:a,fq:"",cursor:"",size:y,sort:"date desc"};return{init:function(){if(0!=jQuery(".archive").length){if(1==jQuery("body.tax-temas").length){localStorage.setItem("enProceso","false"),d=Helper.getLanguageFromUrl(),p="es"==d?"es_ES":"en_US";t("all","initial")}n()}}}},PostPopularList=function(e,a){function t(e){localStorage.setItem("bufferingCache","true");var o,n=Math.ceil(f.length/g);if(y<f.length&&v[e].length<m){h++;var s=[],l=y;o=h<n?g:f.length%g,y=h*g-g+o;for(var j=l;j<y;j++)s.push(f[j].title);var Q={project:a,q:"*",fq:"( and "+u+":'"+d+"' (or wp_text:'post' wp_text:'articulos') (or wp_double:"+s.join(" wp_double:")+") content_language:'"+c+"')",size:g},w=p?JsonManager.searchMockup("cloudsearch_home.json"):JsonManager.search(Q);jQuery.when(w).then(function(a){for(var o=0;o<s.length;o++){for(var n=0;n<a.hits.hit.length&&parseInt(a.hits.hit[n].fields.wp_double)!=parseInt(s[o]);n++);n<a.hits.hit.length&&parseInt(a.hits.hit[n].fields.wp_double)==parseInt(s[o])&&(v.all.push(a.hits.hit[n].fields),"articulos"==a.hits.hit[n].fields.wp_text?v.articulos.push(a.hits.hit[n].fields):"post"==a.hits.hit[n].fields.wp_text&&v.post.push(a.hits.hit[n].fields))}y<f.length&&v[e].length<m?t(e):(localStorage.setItem("bufferingCache","false"),"true"==localStorage.getItem("viewMorePending")?r(e):0==v[e].length&&y==f.length&&i(e))},function(e){console.log("Error en getMasPopulares como resultado de la promesa"),console.log(e)})}else localStorage.setItem("bufferingCache","false");"true"==localStorage.getItem("viewMorePending")&&r(e)}function o(e){var o={project:a},r=p?JsonManager.mostPopularComponentFromMockup("mostpopular_home.json"):JsonManager.mostPopularComponent(o);jQuery.when(r).then(function(a){f=Helper.filtraMasPopularesPorIdioma(a,l),t(e)},function(e){console.log("Error en getMasPopulares como resultado de la promesa"),console.log(e)})}function r(o){if("true"==localStorage.getItem("bufferingCache"))localStorage.setItem("viewMorePending","true");else if(v[o].length<m&&y<f.length)localStorage.setItem("viewMorePending","true"),t(o);else{localStorage.setItem("viewMorePending","false");for(var r,s="",l=new PostView,c=v[o].length,u=0;u<c&&u<m;u++)r=v[o].shift(),r.wp_double>0?s+=l.rellenaPlantilla(r):console.log("Incorrect JSON structure",a,r);n(s,o),Favorites.setFavorites(e),0==v[o].length&&y==f.length&&i(o),t(o)}}function i(e){jQuery(j[e]).hide()}function n(e,a){var t,o=jQuery(e);"articulos"==a?t=jQuery("#articles .popular .grid"):"post"==a&&(t=jQuery("#posts .popular .grid")),"all"==a&&(t=jQuery("#all .popular .grid")),t.masonry({itemSelector:".grid__item",columnWidth:".grid__sizer",gutter:38,percentPosition:!0}),t.append(o).masonry("appended",o),o.imagesLoaded(function(){t.masonry("layout"),jQuery(".masonry-topics .tab-content .svg-spinner").hide()})}function s(){"populares"==jQuery("#selet_all_inicial").val()&&location.reload(!0),jQuery(".select-todos").on("change",function(e){var a=jQuery(this).val(),t=jQuery(this).closest(".tab-pane").find(".all"),o=jQuery(this).closest(".tab-pane").find(".popular"),i=this;if("populares"==a){var n=jQuery(this).closest(".tab-pane").find(".popular .grid");t.css("display","none"),o.show(0,function(){""==n.html().trim()?r(jQuery(i).data("type")):n.masonry("layout")})}else{var n=jQuery(this).closest(".tab-pane").find(".all .grid");o.css("display","none"),t.show(0,function(){n.masonry("layout")})}e.stopImmediatePropagation()}),jQuery(".more-posts a.categoria-popular").on("click",function(e){e.preventDefault(),r(jQuery(this).data("type"))}),jQuery('a[data-toggle="tab"]').on("shown.bs.tab",function(e){var a=jQuery(this).attr("href"),t=jQuery(a).find(".all .grid"),o=jQuery(a).find(".popular .grid");jQuery(a).find(".all .grid").is(":visible")?""!=t.html()&&t.masonry("layout"):""!=o.html()&&o.masonry("layout")})}var l,c,u,d,p=!1,m=12,g=100,f=[],y=0,h=0,v={articulos:[],post:[],all:[]},j={articulos:"#articles .popular .more-posts a",post:"#posts .popular .more-posts a",all:"#all .popular .more-posts a"};return""!=digitalData.page.pageInfo.level2?(u="category",d=digitalData.page.pageInfo.level2):(u="topic",d=digitalData.page.pageInfo.level1),{init:function(){1==jQuery("body.tax-temas").length&&(l=Helper.getLanguageFromUrl(),c="es"==l?"es_ES":"en_US",o("all"),s(),p&&jQuery(".masonry-topics .tab-content .svg-spinner").hide())}}},PostView=function(){return{rellenaPlantilla:function(e){var a="-"!=e.wp_text_array[10]?e.wp_text_array[10]:"",t="-"!=e.wp_text_array[11]?window.location.origin+e.wp_text_array[11]:"",o="-"!=e.wp_text_array[12]?e.wp_text_array[12]:"",r="-"!=e.wp_text_array[4]?"book":"",i="es_ES"==e.content_language?e.wp_text_array[6]:e.wp_text_array[7],n=Helper.traduceCategoria(e.wp_text_array[3]),s=window.location.origin+e.wp_text_array[5],l='<div class="grid__item grid__sizer '+r+'"><ul class="header-card-content"><li><div class="style09 category '+n+' ">';return l=l+'<a href="'+s+' ">'+e.category+"</a>",l+="</div></li><li>","-"!=e.wp_text_array[8]&&(l=l+'<a href="'+window.location.origin+e.resourcename+'">',l=l+'<img class="card-img-top img-fluid" src="'+window.location.origin+e.wp_text_array[8]+'" alt="Card image cap"></a>'),l+='</li></ul><div class="card-block"><div class="card-header">',l=l+'<div class="style12 date">'+i+"</div>",l=l+'<div class="heart" data-id="'+parseInt(e.wp_double)+'" data-name="'+e.title+'" data-url="'+window.location.origin+e.resourcename+'"><span class="icon-heart"></span></div>',l+='</div><h3 class="card-title">',l=l+'<a href="'+window.location.origin+e.resourcename+'">'+e.title+"</a>",l+='</h4><p class="card-text">',l=l+e.description+"</p>",l+='<div class="content-author"><div class="author">',l=l+'<a href="'+t+'">'+a+"</a>",l=l+'</div><div class="author-degree">'+o+"</div>",l+="</div></div></div>"}}},Perfil=function(e,a){function t(a,t,r,i){var n=!1,n=!1;o=e.get("optional_data"),o.name!=a&&(o.name=a,e.set("optional_data",o),contenido=e.get("custom"),e.set("custom",contenido),e.update(function(e){e?(0==n&&(n=!0),jQuery("#mensajes").append("<p>"+mensajes.actualizar_error+"</p>")):jQuery("#mensajes").append("<p>"+mensajes.actualizar_ok+"</p>")})),""!=t&&""!=r&&t!=r&&e.changePassword(t,r,function(e){e?(0==n&&(n=!0),jQuery("#mensajes").append("<p>"+mensajes.cambio_pass_error+"</p>")):jQuery("#mensajes").append("<p>"+mensajes.cambio_pass_ok+"</p>")}),0==n?(jQuery(".action-box").hide(),jQuery(".content-message-ok").show()):jQuery("#mensajes").show()}function r(){o=e.get("optional_data"),jQuery(".breadcrump span:nth-child(2)").html(o.name),jQuery(".info-profile h2").html(o.name);e.get("custom");avatar=o.ow_avatar,jQuery(".img-profile").css("background-image","url("+avatar+")")}function i(){o=e.get("optional_data"),jQuery(".breadcrump span:nth-child(2)").html(o.name),jQuery(".info-profile h2").html(o.name),avatar=o.ow_avatar,jQuery(".img-profile").css("background-image","url("+avatar+")"),jQuery("#name").val(o.name),jQuery("#name").parent().addClass("has-value"),jQuery("label[for=name]").addClass("active"),jQuery("#email").val(e.get("email")),jQuery("#email").parent().addClass("has-value"),jQuery("label[for=email]").addClass("active");var t=jQuery("#newsletter").val(),r=btoa(e.get("email")),i="/bbva-components/private/newsletter/preferences/?project="+a;i=i+"&email="+r,jQuery.get(i,"").done(function(e){-1!=jQuery.inArray(t,e.data.subscribed)&&jQuery("#newsletter").attr("checked",!0)}).fail(function(e,a,t){})}function n(){var a=e.get("custom");favoritos=a.favoritos,jQuery("#lista-favoritos").append('<ul class="fav-list">');for(var t in favoritos)0!=t&&(elem=favoritos[t],jQuery("#lista-favoritos ul").append('<li id="elem_'+elem.id+'"><a href="'+elem.url+'">'+elem.name+'</a><button class="garbage eliminar" data-id="'+elem.id+'"><span class="icon-ico-garbage"></span></button></li>'));jQuery("#lista-favoritos").append("</ul>"),jQuery("#lista-favoritos ul li button.eliminar").click(function(){var a=jQuery(this).data("id");Favorites.removeFavorite(a,e),jQuery(this).parent().remove()})}function s(){jQuery(".cont-related-article, .post-related a, .more-author > div > a").on("click",function(e){var a="",t="";"post-related"==jQuery(this).parent().parent().parent().attr("class")?(t="superior derecha",a=Helper.eliminar_tildes(jQuery(this).text())):(t="inferior",a="more-author"==jQuery(this).parent().parent().attr("class")?Helper.eliminar_tildes(jQuery(this).text()):Helper.eliminar_tildes(jQuery(this).find(".title a").text())),digitalData.news.relatedId=jQuery(this).attr("data-id"),digitalData.news.relatedOriginalTitle=a.toLowerCase(),digitalData.news.relatedPosition=t,"undefined"!=typeof digitalLink&&digitalLink("Related Read Link",digitalData)}),jQuery(".fav").on("click",function(){var a=jQuery(".fav").data("id"),t={id:a,name:jQuery(".fav").data("name"),url:jQuery(".fav").data("url")};"undefined"!=typeof BbvaComponent&&void 0!=e?jQuery(".fav").hasClass("favorito")?(Favorites.removeFavorite(a,e),jQuery(".fav").removeClass("favorito")):(jQuery(".fav").addClass("favorito"),Favorites.addFavorite(t,e)):Helper.goToLoginWithFavorite(t)}),jQuery("#actualizar").click(function(e){e.preventDefault();var o=["name","email","old-password","new-password","repeat-password","legal"],r=jQuery("#name").val(),i=jQuery("#email").val(),n=btoa(jQuery("#email").val()),s=jQuery("#old-password").val(),l=jQuery("#new-password").val(),c=(jQuery("#repeat-password").val(),grecaptcha.getResponse());if(grecaptcha&&0!=c.length){if(FormValidation.validField(jQuery("#ow_recaptcha")),0==FormValidation.validarForm(o)){var u=jQuery("#newsletter").val(),d="/bbva-components/private/newsletter/preferences/?project="+a;d=d+"&email="+n,jQuery.get(d,"").done(function(e){if(-1!=jQuery.inArray(u,e.data.subscribed)){if(0==jQuery("#newsletter").is(":checked")){var t="/bbva-components/newsletter/list/unsubscribe?project="+a+"&listId="+u;t=t+"&email="+n,t=t+"&redirect="+encodeURIComponent(window.location.href),jQuery.get(t,"").done(function(e){}).fail(function(e,a,t){})}}else if(-1!=jQuery.inArray(u,e.data.noSubscribed)&&1==jQuery("#newsletter").is(":checked")){var t="/bbva-components/newsletter/list/"+u+"/subscribe?project="+a,o={email:n,"g-recaptcha-response":c};jQuery.post(t,o).done(function(e){}).fail(function(e,a,t){})}}).fail(function(e,a,t){}),t(r,s,l,i)}}else FormValidation.invalidField(jQuery("#ow_recaptcha"))}),jQuery("#baja").click(function(t){if(t.preventDefault(),void 0!=e){var o="/bbva-components/private/newsletter/preferences/?project="+a;encoded=btoa(e.get("email")),o=o+"&email="+encoded;var r=jQuery("#newsletter").val();jQuery.get(o,"").done(function(e){if(-1!=jQuery.inArray(r,e.data.subscribed)){var t="/bbva-components/newsletter/list/unsubscribe?project="+a+"&listId="+r;t=t+"&email="+encoded,t=t+"&redirect="+encodeURIComponent(window.location.href),jQuery.get(t,"").done(function(e){}).fail(function(e,a,t){})}}).fail(function(e,a,t){});var i="/bbva-components/private/authbbva?project="+a;jQuery.ajax({url:i,type:"DELETE",data:"",dataType:"json",contentType:"application/json",headers:{"Content-Type":"application/json"},processData:!1,success:function(e){-1!==window.location.href.indexOf("/en/")?window.location="/en/removed":window.location="/baja"},error:function(e){console.log("Error en la comunicación de borrado"),jQuery(".action-box").hide(),jQuery(".content-message-ok").show()}})}}),jQuery("#subirimagen").change(function(){jQuery(".img-profile .spinner").css("display","flex"),void 0!=jQuery("#subirimagen").val()&&e.changeAvatar("subirimagen",function(e){jQuery(".spinner").css("display","none"),e?(console.log("[ERROR] No se pudo actualizar la imagen"),FormValidation.invalidField(jQuery("#subirimagen"))):(FormValidation.validField(jQuery("#subirimagen")),location.reload())})})}return{init:function(){if(0<jQuery(".profile-wrapper").length){if(BbvaComponent.isLogged()){if((null==localStorage.getItem("user_estado")||"logado"!=localStorage.getItem("user_estado"))&&digitalData){digitalData.user.profileID=Helper.eliminar_tildes(e.get("username")).toLowerCase(),digitalData.user.userState="logado",digitalData.page.pageActivity.loginType="standard";var a=0,t=setInterval(function(){"undefined"!=typeof digitalLink?(digitalLink("Login",digitalData),clearInterval(t)):10==a&&clearInterval(t),a++},1e3)}localStorage.setItem("user_estado","logado")}Helper.goToReturnPage(e)}if(-1!=window.location.href.indexOf("mi-perfil")||-1!=window.location.href.indexOf("my-profile")?(r(),n()):-1==window.location.href.indexOf("editar-perfil")&&-1==window.location.href.indexOf("edit-profile")||i(),void 0!=e){var o=e.get("custom"),l=o.favoritos;jQuery(".card-header .heart, .article-header .heart, .fav").each(function(){var e=jQuery(this).data("id");void 0!=l&&e in l&&jQuery(this).addClass("favorito")})}s()}}},SearchBar=function(){function e(){jQuery("html, body").css({overflow:"initial",height:"100%"})}function a(){jQuery("html, body").css({overflow:"hidden",height:"100%"})}function t(){jQuery("#searchButton span").removeClass("icon-close"),jQuery("#searchButton span").addClass("icon-finder")}function o(){jQuery(".navbar-nav").toggleClass("deactivated"),jQuery(".language-selector").toggleClass("deactivated"),jQuery(".profile").toggleClass("deactivated"),jQuery(".exit").toggleClass("deactivated")}function r(){jQuery("#searchButton").click(function(){jQuery(".search-main-form").toggleClass("active"),jQuery(".search-main-form-admin-bar").toggleClass("active"),jQuery("#searchButton span").toggleClass("icon-close"),jQuery("#searchButton span").toggleClass("icon-finder"),o()}),jQuery("#searchButton").toggle(function(){a()},function(){e()}),jQuery("#search").click(function(){localStorage.setItem("term_search",jQuery("#searchOM").val()),e(),jQuery(".search-main-form").removeClass("active"),jQuery(".search-main-form-admin-bar").removeClass("active"),t(),o()}),jQuery("#input-search-mobile, #showTopics").click(function(){jQuery(".fakeSearch").toggleClass("active"),jQuery(".trueSearch").toggleClass("active"),jQuery(".trueSearch").attr("placeholder",""),jQuery(".header-topics").toggleClass("hide"),jQuery(".content-topics.active").toggleClass("hide"),jQuery(".content-footer").toggleClass("hide")}),jQuery("#inputTextFormAuthor").click(function(){jQuery(".search-authors").addClass("fullwidth"),jQuery(".search-authors .search-form span.icon-close").addClass("active")}),jQuery("html").click(function(){jQuery(".search-authors").removeClass("fullwidth"),jQuery(".search-authors .search-form span.icon-close").removeClass("active")}),jQuery(".search-form").click(function(e){e.stopPropagation()})}return{init:function(){r()}}},SearchResults=function(e){function a(e,a){if("initial"!=a)t(a,e),jQuery.when(JsonManager.search(y)).then(function(a){s=a,o(e),localStorage.setItem("enProceso","false")},function(e){
console.log("Error en resultado Busqueda como resultado de la promesa"),console.log(e)});else{y.q="*"+n+"*",t(a,"all");var r=u?JsonManager.searchMockup("search_global_all.json"):JsonManager.search(y);t(a,"articulos");var i=u?JsonManager.searchMockup("search_global_article.json"):JsonManager.search(y);t(a,"autores");var l=u?JsonManager.searchMockup("search_global_author.json"):JsonManager.search(y);t(a,"multimedia");var c=u?JsonManager.searchMockup("search_global_multimedia.json"):JsonManager.search(y);Promise.all([r,i,l,c]).then(function(e){s=e;var a=decodeURI(n.replace(/\+/g," "));jQuery("#searchOMpage").val(a),digitalData.page.pageActivity.search.onSiteSearchEnterTerm=a,jQuery("#tab_articles_post .searchresults").html(s[1].hits.found),jQuery("#tab_authors .searchresults").html(s[2].hits.found),jQuery("#tab_multimedia .searchresults").html(s[3].hits.found),digitalData.page.pageActivity.search.onSiteSearchResults=s[0].hits.found.toString(),digitalData.page.pageActivity.search.onSiteSearchTerm="",localStorage.setItem("term_search",""),o("all"),o("articulos"),o("autores"),o("multimedia"),jQuery(".search-results-custom .table-results .svg-spinner").hide(),localStorage.setItem("enProceso","false"),"undefined"!=typeof digitalData&&"function"==typeof digitalView?digitalView("Page View",digitalData):setTimeout(function(){"undefined"!=typeof digitalData&&"function"==typeof digitalView&&digitalView("Page View",digitalData)},5e3)},function(e){console.log("Error en resultados de Busquedas como resultado de las promesas"),console.log(e)})}}function t(e,a){y.cursor=e,"all"===a?(y.fq="content_language:'"+c+"'",y.sort="date desc"):"articulos"===a?(y.fq="( and (or wp_text:'post' wp_text:'articulos') ( and (not wp_text_array:'pasatiempos') (not wp_text_array:'infografia') (not wp_text_array:'interactivo') (not wp_text_array:'quiz') ) content_language:'"+c+"' )",y.sort="date desc"):"autores"===a?(y.fq="( and wp_text:'autores' content_language:'"+c+"')",y.sort="description asc"):"multimedia"===a&&(y.fq="( and ( or wp_text:'videos' wp_text:'audios' wp_text_array:'pasatiempos' wp_text_array:'infografia' wp_text_array:'interactivo' wp_text_array:'quiz' ) content_language:'"+c+"' )",y.sort="date desc")}function o(a){var t=0!=p[a]?s:s[g[a]];m[a]=t.hits.cursor,p[a]++;var o=t.hits.found;if(0==o)r(a);else{var i=t.hits.hit.length;p[a]*d+i>=o&&r(a);for(var n=new SearchView,l=0;l<i;l++)t.hits.hit[l].fields.wp_double>0?jQuery(f[a]).append(n.renderFoundItem(t.hits.hit[l].fields)):console.log("JSON problem",id,e,t.hits.hit[l])}}function r(e){"all"==e?jQuery("#all .more-posts a").hide():"articulos"==e?jQuery("#articles-post .more-posts a").hide():"autores"==e?jQuery("#authors .more-posts a").hide():"libros"==e?jQuery("#books .more-posts a").hide():"multimedia"==e&&jQuery("#multimedia .more-posts a").hide()}function i(){jQuery(".more-posts a").click(function(e){if(e.preventDefault(),"true"!==localStorage.getItem("enProceso")){localStorage.setItem("enProceso","true");var t=jQuery(this).data("type");a(t,m[t])}else console.log("Paginación en proceso.")}),jQuery("#searchLauncher").on("click",function(e){e.preventDefault(),jQuery("#searchFormPage").submit()})}var n,s,l,c,u=!1,d=12,p={all:0,articulos:0,autores:0,multimedia:0},m={all:"",articulos:"",autores:"",multimedia:""},g={all:0,articulos:1,autores:2,multimedia:3},f={all:".search-result-all",articulos:".search-result-articles-post",autores:".search-result-authors",multimedia:".search-result-multimedia"},y={q:"",project:e,fq:"",cursor:"",size:d,sort:""};return{init:function(){n=Helper.getUrlParameter("searchOM"),l=Helper.getLanguageFromUrl(),c="es"==l?"es_ES":"en_US",localStorage.setItem("enProceso","false"),null!==n?(a("all","initial"),i()):jQuery(".search-results-custom .table-results .svg-spinner").hide()}}},SearchTags=function(e){function a(e,a){if("initial"!=a)t(a,e),jQuery.when(JsonManager.search(y)).then(function(a){s=a,o(e),localStorage.setItem("enProcesoTags","false")},function(e){console.log("Error en resultado Busqueda como resultado de la promesa"),console.log(e)});else{y.q="*",t(a,"all");var r=u?JsonManager.searchMockup("search_global_all.json"):JsonManager.search(y);t(a,"articulos");var i=u?JsonManager.searchMockup("search_global_article.json"):JsonManager.search(y);t(a,"multimedia");var l=u?JsonManager.searchMockup("search_global_multimedia.json"):JsonManager.search(y);Promise.all([r,i,l]).then(function(e){s=e,jQuery("#searchOMpage").val(decodeURI(n.replace(/\+/g," "))),jQuery("#tab_articles_post .searchresults").html(s[1].hits.found),jQuery("#tab_multimedia .searchresults").html(s[2].hits.found),o("all"),o("articulos"),o("multimedia"),jQuery(".search-results-custom .table-results .svg-spinner").hide(),localStorage.setItem("enProcesoTags","false")},function(e){console.log("Error en resultados de Busquedas como resultado de las promesas"),console.log(e)})}}function t(e,a){y.cursor=e,"all"===a?(y.fq="content_language:'"+c+"' keywords:'"+n+"'",y.sort="date desc"):"articulos"===a?(y.fq="( and (or wp_text:'post' wp_text:'articulos') ( and (not wp_text_array:'pasatiempos') (not wp_text_array:'infografia') (not wp_text_array:'interactivo') (not wp_text_array:'quiz') ) content_language:'"+c+"' keywords:'"+n+"' )",y.sort="date desc"):"multimedia"===a&&(y.fq="( and ( or wp_text:'videos' wp_text:'audios' wp_text_array:'pasatiempos' wp_text_array:'infografia' wp_text_array:'interactivo' wp_text_array:'quiz' ) content_language:'"+c+"' keywords:'"+n+"' )",y.sort="date desc")}function o(a){var t=0!=p[a]?s:s[g[a]];m[a]=t.hits.cursor,p[a]++;var o=t.hits.found;if(0==o)r(a);else{var i=t.hits.hit.length;p[a]*d+i>=o&&r(a);for(var n=new SearchView,l=0;l<i;l++)t.hits.hit[l].fields.wp_double>0?jQuery(f[a]).append(n.renderFoundItem(t.hits.hit[l].fields)):console.log("JSON problem",id,e,t.hits.hit[l])}}function r(e){"all"==e?jQuery("#all .more-posts a").hide():"articulos"==e?jQuery("#articles-post .more-posts a").hide():"autores"==e?jQuery("#authors .more-posts a").hide():"libros"==e?jQuery("#books .more-posts a").hide():"multimedia"==e&&jQuery("#multimedia .more-posts a").hide()}function i(){jQuery(".more-posts a").click(function(e){if(e.preventDefault(),"true"!==localStorage.getItem("enProcesoTags")){localStorage.setItem("enProcesoTags","true");var t=jQuery(this).data("type");a(t,m[t])}else console.log("Paginación en proceso.")}),jQuery("#searchLauncher").on("click",function(e){e.preventDefault(),jQuery("#searchFormPage").submit()})}var n,s,l,c,u=!1,d=12,p={all:0,articulos:0,multimedia:0},m={all:"",articulos:"",multimedia:""},g={all:0,articulos:1,multimedia:2},f={all:".search-result-all",articulos:".search-result-articles-post",multimedia:".search-result-multimedia"},y={q:"",project:e,fq:"",cursor:"",size:d,sort:""};return{init:function(){n=Helper.getUrlParameter("searchTagsOM"),l=Helper.getLanguageFromUrl(),c="es"==l?"es_ES":"en_US",localStorage.setItem("enProcesoTags","false"),null!==n?(a("all","initial"),i()):jQuery(".search-results-custom .table-results .svg-spinner").hide()}}},SearchView=function(){Helper.getLanguageFromUrl();return{renderFoundItem:function(e){var a="",t="es_ES"==e.content_language?e.wp_text_array[6]:e.wp_text_array[7];if(a+='<div class="item"><div class="item-text-information">',"libros"!=e.wp_text&&"autores"!=e.wp_text?(e.topic&&(a=a+'<div class="style09 category '+e.wp_text_array[3]+'"><h3 class="category"><a href="'+window.location.origin+e.wp_text_array[5]+'">'+e.category+"</a></h3></div>"),t&&(a=a+'<div class="style12 date">'+t+"</div>")):"libros"==e.wp_text?(a+='<div class="style09 category libros">',a="es_ES"==e.content_language?a+'<h3 class="category"><a href=" '+window.location.origin+'/libros/">Libros</a></h3>':a+'<h3 class="category"><a href="'+window.location.origin+'/en/books/">Books</a></h3>',a+="</div>",t&&(a=a+'<div class="style12 date">Desde '+t+" · "+e.wp_text_array[21]+"</div>")):"autores"==e.wp_text&&(a+='<div class="style09 category autores">',a="es_ES"==e.content_language?a+'<h3 class="category"><a href=" '+window.location.origin+'/autores/">Autor</a></h3>':a+'<h3 class="category"><a href="'+window.location.origin+'/en/authors/">Author</a></h3>',a+="</div>",t&&(a=a+'<div class="style12 date">'+t+"</div>")),a=a+'<h2><a href="'+window.location.origin+e.resourcename+'">'+e.title+"</a></h2>","autores"===e.wp_text&&e.wp_double>0){if(a=a+"<p>"+e.wp_text_array[0]+"</p>",e.wp_text_array[22]&&"-"!=e.wp_text_array[22]){var o=e.wp_text_array[22];o&&"-"!=o&&(o=JSON.parse(o),a+='<div class="authors-category-search">',jQuery.each(o,function(){a=a+'<a href="'+window.location.origin+this.link+'">'+this.name+"</a>"}),a+="</div>")}}else e.wp_text_array[19]&&"-"!=e.wp_text_array[19]&&(a=a+"<p>"+e.wp_text_array[19]+"</p>"),e.wp_text_array[10]&&"-"!=e.wp_text_array[10]&&(a=a+'<div class="author"><a href="'+window.location.origin+e.wp_text_array[11]+'">'+e.wp_text_array[10]+"</a></div>");return a+="</div>","-"!=e.wp_text_array[8]&&(a+='<div class="item-img-information">',a=a+'<a href="'+window.location.origin+e.resourcename+'">',a+='<div class="img-article">',"autores"===e.wp_text?(a=a+'<img src="'+window.location.origin+e.image_src+'" alt="imagen del autor" />',"colaborador"!=e.wp_text_array[1]&&(a+='<div class="ico-book"><span class="icon-book"></span></div>')):(a=a+'<img src="'+window.location.origin+e.wp_text_array[8]+'" alt="imagen de la publicación" />',"videos"==e.wp_text?a+='<div class="play"></div>':"audios"==e.wp_text?a+='<div class="mic"></div>':"articulos"==e.wp_text&&(a+='<div class="ico-book"><span class="icon-book"></span></div>')),a+="</div></a></div>"),a+="</div>"}}},TimeLine=function(){function e(e){var a=jQuery(".header-js.sticky").length?jQuery(".header-js.sticky").height():0,t=jQuery(".timeline-nav").offset().top;jQuery("html, body").animate({scrollTop:t-a},e)}function a(){jQuery(window).on("scroll",function(){jQuery(window).scrollTop()>jQuery(".timeline-content").offset().top+50?jQuery(".btn-up").fadeIn(250):jQuery(".btn-up").fadeOut(250)}),jQuery(".btn-up a").click(function(a){a.preventDefault(),e(500)}),jQuery(".timeline-intro .arrow-timeline").click(function(a){a.preventDefault(),e(500)}),jQuery(document).on("change","#month",function(e){e.preventDefault(),t=jQuery("#month option:selected").val(),t=t.toLowerCase().replace(/ /g,""),o="#"+t,jQuery("#ancla-menu").attr("href",o),jQuery("#ancla-menu").click()}),jQuery("#ancla-menu").click(function(e){e.preventDefault();var a=jQuery(".header-js").height(),t=jQuery(this).attr("href");jQuery(".lazyBlock").show(),jQuery(t).length&&jQuery("body,html").stop(!0,!0).animate({scrollTop:jQuery(t).offset().top-a-90},1e3)})}var t="",o="";return{init:function(){0!=jQuery(".timeline-intro").length&&a()}}},UserManager=function(e,a){function t(){jQuery(".exit").on("click",function(a){a.preventDefault(),void 0!=e&&e.logout(function(e){e?console.log("error logout"):(localStorage.setItem("user_estado","no logado"),digitalData&&(digitalData.user.userState="no logado",digitalData.user.profileID="","undefined"!=typeof digitalLink&&digitalLink("Logout",digitalData))),-1!=window.location.href.indexOf("/en/")?window.location.href="/en/":window.location.href="/"})})}function o(){jQuery("#submit-registration").on("click",function(e){e.preventDefault();var t=["name","email","new_password","repeat_password","legal"],o=jQuery("#name").val(),r=(o.split(" ").join("_"),jQuery("#email").val()),i=jQuery("#new_password").val();jQuery("#repeat_password").val();if(0==FormValidation.validarForm(t)){var n="";n=-1!=window.location.href.indexOf("/en/")?"en":"es";var s="/bbva-components/authbbva?project="+a,l={method:"POST",type:"POST",url:s,dataType:"json",contentType:"application/json"},c={email:r,username:r,password:btoa(i),custom:{},optional_data:{name:o,ow_lang:n}};l.data=JSON.stringify(c),jQuery.ajax(l).done(function(e){if(jQuery(".action-box").hide(),200==e.code||202==e.code){jQuery(".content-message-ok").show();var a=window.location.href,t=window.location.pathname,o=a.substring(0,a.indexOf(t)+4),r=o+"login/";Helper.setReturnPage(r)}else jQuery(".content-message-ko").show()}).fail(function(e,a,t){jQuery(".action-box").hide(),jQuery(".content-message-ko").show()})}})}return{init:function(){if(void 0==e)jQuery(".profile #perfil").hide(),jQuery(".profile #login").show(),jQuery(".profile #perfil-mobile").hide(),jQuery(".profile #login-mobile").show(),jQuery(".exit").hide();else{if(void 0==e.get("optional_data").name){user_profileID.replace(/@.*$/,"");jQuery(".info-profile h2").html(user_profileID)}jQuery(".profile #login").hide(),jQuery(".profile #perfil").show(),jQuery(".profile #login-mobile").hide(),jQuery(".profile #perfil-mobile").show(),jQuery(".exit").show(),jQuery(".menu-mobile .exit").css("display","flex")}t(),o()}}};